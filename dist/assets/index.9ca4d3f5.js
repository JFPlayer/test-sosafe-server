var e=Object.defineProperty,t=Object.defineProperties,a=Object.getOwnPropertyDescriptors,n=Object.getOwnPropertySymbols,l=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,o=(t,a,n)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[a]=n,c=(e,t)=>{for(var a in t||(t={}))l.call(t,a)&&o(e,a,t[a]);if(n)for(var a of n(t))r.call(t,a)&&o(e,a,t[a]);return e},s=(e,n)=>t(e,a(n));import{a as i,c as m,b as p,d as u,e as d,t as E,u as g,f as y,r as S,L as f,g as _,R as h,M as b,T as k,h as w,P as N,i as O,j as R,k as T,B as v,S as A,l as C,m as x}from"./vendor.4db2fef0.js";const P=e=>{const t=e.slice(0,6);return localStorage.setItem("keywords",JSON.stringify(t)),t},K={currentLocation:{description:"Obelisco",latlng:{lat:"-34.603709113846776",lng:"-58.3815622329712"}},zoom:18,onEdit:!1,markers:[],keywords:[]};const M=({description:e,latlng:t})=>({type:"SET_CURRENT_LOCATION",payload:{description:e,lat:t.lat,lng:t.lng}}),D=({description:e,latlng:t})=>async a=>{a({type:"UPDATE_MARKERS",payload:await(({description:e,latlng:t})=>i.post("/api/locations",{description:e,latlng:t}).then((({data:e})=>e.body)).catch((e=>{throw new Error(e)})))({description:e,latlng:t})})},L=e=>async t=>{try{const a=await(e=>{const t=e?`/api/locations?search=${e}`:"/api/locations";return i.get(t).then((({data:e})=>e.body)).catch((e=>{throw new Error(e)}))})(e);t({type:"SET_MARKERS",payload:a}),e&&a.length&&t(j(e))}catch(a){}},U=()=>({type:"SET_KEYWORDS",payload:(()=>{const e=localStorage.getItem("keywords");return e?JSON.parse(e):[]})()}),j=e=>(t,a)=>{const{keywords:n}=a().location;let l=!1,r=n.map((t=>t.includes(e)||e.includes(t)?(l=!0,t.length>e.length?t:e):t));l||(r=[e,...r]),t({type:"UPDATE_KEYWORDS",payload:P(r)})},z={socket:null,map:null};var I=p(m({location:(e=K,{type:t,payload:a})=>{switch(t){case"SET_CURRENT_LOCATION":return s(c({},e),{currentLocation:{description:a.description||"",latlng:{lat:a.lat,lng:a.lng}}});case"SET_MARKERS":return s(c({},e),{markers:a});case"UPDATE_MARKERS":return s(c({},e),{markers:[...e.markers,a]});case"RESET_MARKERS":return s(c({},e),{markers:[]});case"UPDATE_KEYWORDS":case"SET_KEYWORDS":return s(c({},e),{keywords:a});default:return e}},global:(e=z,{type:t,payload:a})=>{switch(t){case"SET_SOCKET":return s(c({},e),{socket:a});case"SET_MAP":return s(c({},e),{map:a});default:return e}}}),(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||d)(u(E)));const W=()=>{const e=g(),t=y({click:a=>{const{latlng:n}=a;t.flyTo(n),e(M({latlng:n}))},moveend:()=>{const a=t.getCenter();e(M({latlng:a}))}});return S.exports.useEffect((()=>{e((e=>({type:"SET_MAP",payload:e}))(t))}),[]),null};var Y="/assets/icon.9f4d1ec7.svg";const q=f.icon({iconUrl:Y,iconRetinaUrl:Y,iconAnchor:null,shadowUrl:null,shadowSize:null,shadowAnchor:null,iconSize:[35,35],className:"leaflet-venue-icon"}),B=()=>{const{markers:e,currentLocation:t,zoom:a}=_((e=>e.location)),{socket:n}=_((e=>e.global)),l=g(),r={click:t=>{const{latlng:a}=t,r=e.find((e=>{const{lat:t,lng:n}=e.latlng;if(t==a.lat&&n==a.lng)return!0}));r&&(l(M({latlng:r.latlng,description:r.description})),n.emit("visitedLocation",r._id))}};return h.createElement(b,{center:t.latlng,zoom:a},h.createElement(k,{attribution:'&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),h.createElement(W,null),e.map((e=>h.createElement(w,{key:e._id,position:e.latlng,eventHandlers:r,icon:q},h.createElement(N,null,e.description)))))},V=({children:e})=>{const[t,a]=S.exports.useState(!0);return h.createElement("main",{className:"layout "+(t?"":"disabled")},h.createElement("aside",{className:"layout_panel"},e,h.createElement("button",{className:"panel_btn-drop-down",onClick:()=>a(!t)},"<")),h.createElement("div",{className:"layout_map"},h.createElement(B,null)))};const $=()=>{const{register:e,handleSubmit:t}=O(),a=g(),{keywords:n}=_((e=>e.location));S.exports.useEffect((()=>{a(U())}),[]);return h.createElement("form",{onSubmit:t((e=>{a(L(e.keyword))})),className:"search-bar"},h.createElement("input",s(c({},e("keyword")),{type:"text",autoComplete:"off",list:"keywordsList"})),h.createElement("datalist",{id:"keywordsList"},n.map((e=>h.createElement("option",{key:e,value:e})))),h.createElement("button",null,"BUSCAR"))};const F=()=>{const{markers:e,zoom:t}=_((e=>e.location)),{socket:a,map:n}=_((e=>e.global));return h.createElement("div",{className:"search-results"},e.map((e=>h.createElement("div",{key:e._id,className:"results-item",onClick:()=>(e=>{n.flyTo(e.latlng,t),a.emit("visitedLocation",e._id)})(e)},h.createElement("div",{className:"results-item_title"},e.description),h.createElement("span",{className:"results-item_coords"},`Coordenadas: ${e.latlng.lat}, ${e.latlng.lng}`)))))},J=()=>h.createElement("div",{className:"home"},h.createElement($,null),h.createElement(F,null),h.createElement(R,{to:"/control-panel",className:"home_link"},"Editar/Crear"));const X=()=>{const{register:e,handleSubmit:t,setValue:a}=O(),{currentLocation:n}=_((e=>e.location)),l=g();S.exports.useEffect((()=>{a("latlng.lat",n.latlng.lat),a("latlng.lng",n.latlng.lng),a("description",n.description)}),[n]);return h.createElement("form",{className:"location-form",onSubmit:t((e=>{l(D(e))})),onChange:e=>{const{value:t,name:n}=e.target;t.match(/\de\-/)&&a(n,parseFloat(t).toFixed(15))}},h.createElement("div",{className:"location-form_inputs-container"},h.createElement("input",s(c({className:"location-form_input-coord"},e("latlng.lat")),{required:!0,min:-90,max:90,type:"number",step:"0.000000000000001"})),h.createElement("input",s(c({className:"location-form_input-coord"},e("latlng.lng")),{required:!0,min:-90,max:90,type:"number",step:1e-15}))),h.createElement("input",s(c({className:"location-form_input-descrip"},e("description")),{required:!0})),h.createElement("button",{className:"location-form_btn"},"CREAR"))},H=()=>{const e=g();return S.exports.useEffect((()=>(e(L()),()=>{e({type:"RESET_MARKERS"})})),[]),h.createElement("div",{className:"control-panel"},h.createElement(X,null),h.createElement(R,{to:"/",className:"control-panel_link"},"Volver atras"))};function G(){const e=g();return S.exports.useEffect((()=>{const t=io();e((e=>({type:"SET_SOCKET",payload:e}))(t))}),[]),h.createElement(T,{store:I},h.createElement(V,null,h.createElement(v,null,h.createElement(A,null,h.createElement(C,{exact:!0,path:"/",component:J}),h.createElement(C,{exact:!0,path:"/control-panel",component:H})))))}x.render(h.createElement(h.StrictMode,null,h.createElement(T,{store:I},h.createElement(G,null))),document.getElementById("root"));
